<nav class="sidebar">
    <div class="sidebar-title">Category Theory</div>
    <div class="sidebar-subtitle">Formalized in Agda</div>

    {% comment %}
    Automatically construct navigation sections from page front matter.
    Pages with a 'section' field will be grouped and ordered by their 'order' field.
    {% endcomment %}

    {% assign sections = site.pages | where_exp: "page", "page.section != nil" | group_by: "section" | sort: "name" %}

    {% for section_group in sections %}
        <div class="nav-section">
            <h3>{{ section_group.name }}</h3>
            <ol>
                {% assign section_pages = section_group.items | sort: "number" %}
                {% for page in section_pages %}
                    <li>
                        <a href="{{ page.url | relative_url }}">{{ page.chapter }}.{{ page.number }} {{ page.title }}</a>
                        {% if page.subsections %}
                            <ol>
                                {% for subsection in page.subsections %}
                                    <li><a href="{{ page.url | relative_url }}#{{ subsection.anchor }}">{{ subsection.chapter }}.{{ subsection.number }} {{ subsection.name }}</a></li>
                                {% endfor %}
                            </ol>
                        {% endif %}
                    </li>
                {% endfor %}
            </ol>
        </div>
    {% endfor %}

    <div class="nav-section">
        <h3>Home</h3>
        <ol>
            <li><a href="{{ '/' | relative_url }}">‚Üê Back to Home</a></li>
        </ol>
    </div>
</nav>
